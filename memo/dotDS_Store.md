## 不可視ファイルをgitで追跡しないようにする

GitHub でファイルを管理する際、コードが中心であったり、Web版のGitHubしか使わなかったりということであれば問題はない。しかしながら、たとえばMacで`GitHub Desktop.app`を使うと、macOS の不可視ファイル（`.DS_Store`, `._*`）までgitが舐めてくれるので、面倒です。面倒なだけならばよいのですが、`.DS_Store`自身がコンフリクトを起こしてしまうと、不可視ファイルなだけにシェルが使えないユーザには対処が困難となります。コンフリクトが起こる前に対処しておいたほうがよさそうです。

1. リポジトリのクローン環境（2台のMacを使っているなら、2台とも）で、Terminalを使って、以下の設定を置いてください。

```
~/.config/git/ignore
```
vi か何かのエディタでignoreに`.DS_Store`とだけ書いて保存してください（vi の場合には、`cd .config/git/; vi ./ignore` → i で insert モード、Esc : →wq; cat などでファイルが正しくできているか確認してください）。

2. 引き続き、Terminalを使って、クローンのディレクトリの先頭をカレントディレクトリとして、そこに移動してください。

```
find ./ \( -name ".DS_Store" -or -name "._*" \)
```
とすると、それ以下の子・孫ディレクトリなども含めて `.DS_Store` や` ._*` があるとリストで表示します。数が少なければ、手動で`rm`します。数が多くてつらい場合には、上記をパイプでつないですべてを一括削除します。`rm -rf` で強制的に消しますので、気になる場合には、次のようにして確認してください。
対象ファイル数を数える場合、`wc` に引き渡します。
```
find ./ \( -name ".DS_Store" -or -name "._*" \) | wc
```
```
find ./ \( -name ".DS_Store" -or -name "._*" \) | xargs echo rm -rf
```
長く続てどんどん流れてしまう場合には、さらにパイプでつないで `less` などに引き渡します。
```
find ./ \( -name ".DS_Store" -or -name "._*" \) | xargs rm -rf
```
`xargs`は前の処理を受けて、柔軟にパイプ処理を行い、一括処理を可能にします。ただし、ファイル名に特殊文字が使われていると処理がうまくいかない可能性もあるので、`find`コマンドに `-print0` 	オプションをとります。同時に、`xargs` にも `-0`	 オプションを指定するほうがよいかもしれません（未確認）。
```
find ./ \( -name ".DS_Store" -or -name "._*" \) -print0 | xargs -0 rm -rf
```

これで、pushすれば、不可視ファイルがなくなり、以降はgitの探索の対象から外れます。

------
上記でほぼ問題ないはずですが、`git`が不可視ファイルを追跡したままになっている、期待どおりに不可視ファイルを無視してくれないので、キャッシュをクリアします。まずは、当該リポジトリのカレントディレクトリに移動します。そこで、
```
git rm --cached .DS_Store　あるいは　git rm --cached .
```
とします。`.`  はカレントディレクトリを指しますが、それ以下の子・孫ディレクトリなどにも有効です。
